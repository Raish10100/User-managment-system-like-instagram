<!DOCTYPE html>
<html>
    <head>
        <title>Instagram signup</title>
        <link rel="stylesheet" href="style.css">

     </head>
    <body>
    <h1 id="instaPage">Instagram </h1>

        <div class="container">
            <h1>Instagram SignUp Page</h1>
            <form action="">
                <div class="form-group">
                    <label for="">Name</label>
                    <input type="text" name="name"   id="name" placeholder="Enter your Name">
                </div>
                <div class="form-group">
                    <label for="">Username</label>
                    <input type="text" name=""   id="username" placeholder="Enter your username">
                </div>
                <div class="form-group">
                    <label for="">Email</label>
                    <input type="text" name=""   id="email" placeholder="Enter your Email">
                </div>
                <div class="form-group">
                    <label for="">Password</label>
                    <input type="text" name=""   id="password" placeholder="Enter your password">
                </div>
                <div class="form-group">
                    <label for="">bio</label>
                    <input type="text" name=""   id="bio" placeholder="Enter you Bio">
                </div>

                <a href="" id="submit" class="btn">signup</a>
                
            </form>
                <div class="links">
                    <a href="./ForgetPassword.html">Forget Password?</a>
                    <a href="./Login.html">Log In</a>
                </div>
        </div>
    </body>


    <script>
        const formSubmit = document.getElementById("submit");
        formSubmit.addEventListener('click',(event) => {
event.preventDefault()
const userName = document.getElementById('username').value
const userEmail = document.getElementById('email').value
const nameOfUser = document.getElementById('name').value
const userBio = document.getElementById('bio').value
const userPassword = document.getElementById('password').value

// console.log(userName,userEmail,nameOfUser,userBio,userPassword)


if(!userName || !userName || !userEmail || !userPassword || !nameOfUser || !userBio){
   return alert("All input field are required")
}

const userData = {
    name: nameOfUser,
    email: userEmail,
    bio: userBio,
    password: userPassword,
    username: userName
}
// console.log(userData)
registerUser(userData) 
        })

const registerUser = async(payload) => {
    try {
        const resp = await fetch("http://localhost:50001/api/auth/signup",{
            method: "POST",
            headers: {"content-type": "application/json"},
            body: JSON.stringify(payload)
        })

        const data = await resp.json();
        console.log(data);
const success = data.success

if(success){
    window.location.href="http://localhost:5500/client/login.html"
}else{
    alert("This username or email is already exists, please fill different username and email")
}
    } catch (error) {
if(erro.code === 11000){
    return alert("This account already exists!!  ")
}

        console.log(`Error is : ${error.message}`)
    }
}
        
    </script>
</html>